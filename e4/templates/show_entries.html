{% extends "layout.html" %}
{% block js %}
<!--
<script src="{{url_for('static', filename='up.js')}}"></script>
-->
<script>
  
</script>

{% endblock %}
{% block body %}

  {% if session.logged_in %}
  {% endif %}
    <form action="{{ url_for('add_entry') }}" method=post class=add-entry id="income">
      <dl>
        <dt>ID</dt><dd><input type=text name=id value="" size=4 disabled></dd>
        <dt>Title</dt><dd><input type=text size=30 name=title ></dd>
        <dt>Currency</dt><dd><select name=currency_id class=currency_selector></select></dd>
        <dt>Summ</dt><dd><input name=sum size=11 ></dd>
        <dt>Dates</dt><dd><input name=start_date size=11 class=datepicker> <input name=end_date size=11 class=datepicker></dd>
        <dt>Period</dt><dd><select name=period_id class="period_selector"></select></dd>
          
      </dl>
    </form>

    <form action="{{ url_for('dispatcher') }}" method=post class=add-entry id="transaction">
      <dl>
        <dt>ID</dt><dd><input type=text name=id class=id value="" size=4 disabled></dd>
        <dt>Summ</dt><dd><input name=sum class=sum size=11></dd>
        <dt>Time</dt><dd><input type=text size=30 name=title class="time datepicker" value=""></dd>
        <dt>Account</dt><dd><select name=account class="account account_selector"></select></dd>
        <dt>Comment</dt><dd><input name=comment class="comment"></input></dd>
      </dl>
      </form>
  
  <table class=entries id=incomes_table>
    <caption>Incomes</caption>
    <tr>
        <th>Title</th>
        <th>Summ</th>
        <th>Currency</th>
        <th>Dates</th>
        <th><a href=# onclick="update_row(event, '#income'); $('#income')[0].reset();"><img width='10' height='10' src='/static/iconmonstr-edit-8.svg'/></a></th>
      </tr>

  {% for entry in entries %}
  <tr>
    <td>
      <span class="hidden row_update" name=id >{{entry.id}}</span>
      <span class=row_update name=title>{{ entry.title|safe }}</span>
    </td>
    <td class=row_update name=sum>
      {{ entry.sum }}
    </td>
    <td>
      {{ entry.currency }}
      <span class="hidden row_update" name=currency_id>{{ entry.currency_id }}</span>
    </td>
    <td>  
      {{ entry.period.title }}
      <span class="hidden row_update" name=period_id>{{ entry.period_id }}</span>
      from <span name=start_date class=row_update> {{ entry.start_date.strftime('%Y-%m-%d') }}</span><span {% if entry.end_date %}class="hidden"{% endif %}> till <span class=row_update name=end_date>{% if entry.end_date %}{{ entry.end_date.strftime('%Y-%m-%d') }}{% endif %}</span></span>
    </td>
    <td>
      <a href=# onclick="update_row(event, '#income')"><img width='10' height='10' src='/static/iconmonstr-edit-5.svg'/></a>&nbsp;<a href=# onclick="delete_income(event)"><img width='10' height='10' src='/static/iconmonstr-x-mark-7.svg'/></a>
    </td>
      {% else %}
    <tr>
      <td><em>Unbelievable.  No entries here so far</em></td>
    </tr>
  {% endfor %}
      </table>
   <table id=transactions_table>
      <caption>transactions</caption>
      <tr>
        <th>id</th>
        <th>time</th>
        <th>sum</th>
        <th>account</th>
        <th>comment</th>
        <th><a href=# onclick="update_row(event, '#transaction')"><img width='10' height='10' src='/static/iconmonstr-edit-8.svg'/></a></th>
      </tr>
      <tr>
{% for entry in transactions %}
     <tr>
       <td class=row_update name=id>{{ entry.id }}</td>
       <td class=row_update name=time>{{ entry.time }}</td>
       <td class=row_update name=sum>{{ entry.sum }}</td>
       <td><span class=row_update name=account>{{ entry.account.id }}</span>{{ entry.account.title }} ({{ entry.account.currency.title }})</td>
       <td class=row_update name=comment>{{ entry.comment }})</td>
       <td><a href=# onclick="update_row(event, '#transaction')"><img width='10' height='10' src='/static/iconmonstr-edit-5.svg'/></a>&nbsp;<a href=# onclick="delete_transaction(event)"><img width='10' height='10' src='/static/iconmonstr-x-mark-7.svg'/></a></td>
     </tr>
{% endfor %}
   </table>
{% endblock %}
